<!DOCTYPE html>
<html>
<head>
    <title>Teste de Autenticação</title>
</head>
<body>
    <h1>Teste de Autenticação API</h1>
    <button onclick="testLogin()">Testar Login</button>
    <button onclick="testUpload()">Testar Upload</button>
    <div id="result"></div>

    <script>
        const API_BASE = 'http://127.0.0.1:8000/api';
        let accessToken = null;

        async function testLogin() {
            try {
                const response = await fetch(`${API_BASE}/token/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        login: 'admin',
                        password: 'admin'  // Usando senha padrão
                    })
                });
                
                const data = await response.json();
                if (response.ok) {
                    accessToken = data.access;
                    document.getElementById('result').innerHTML = `<p style="color: green;">Login bem-sucedido! Token: ${accessToken.substring(0, 20)}...</p>`;
                } else {
                    document.getElementById('result').innerHTML = `<p style="color: red;">Erro no login: ${JSON.stringify(data)}</p>`;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `<p style="color: red;">Erro: ${error.message}</p>`;
            }
        }

        async function testUpload() {
            if (!accessToken) {
                document.getElementById('result').innerHTML = `<p style="color: red;">Faça login primeiro!</p>`;
                return;
            }

            try {
                // Criar um arquivo de teste
                const testFile = new Blob(['Teste de upload'], { type: 'text/plain' });
                const formData = new FormData();
                formData.append('arquivo', testFile, 'teste.txt');
formData.append('obra', '8');  // Usando obra existente: PONTA PORÃ
                formData.append('categoria', 'DOCUMENTO');
                formData.append('descricao', 'Arquivo de teste');

                const response = await fetch(`${API_BASE}/arquivos-obra/`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`
                    },
                    body: formData
                });

                const data = await response.json();
                if (response.ok) {
                    document.getElementById('result').innerHTML += `<p style="color: green;">Upload bem-sucedido! Arquivo ID: ${data.id}</p>`;
                } else {
                    document.getElementById('result').innerHTML += `<p style="color: red;">Erro no upload: ${JSON.stringify(data)}</p>`;
                }
            } catch (error) {
                document.getElementById('result').innerHTML += `<p style="color: red;">Erro no